<div class="cuento-card">
  <span class="badge" *ngIf="badgeLabel" [ngClass]="{'nuevo': badgeLabel==='Nuevo', 'top': badgeLabel.toLowerCase().includes('top')}">{{ badgeLabel }}</span>
  <div class="image-wrapper">
    <img #cardImg class="hover-scale" [appLazyLoad]="cuento.imagenUrl || 'assets/placeholder-cuento.jpg'" alt="{{cuento.titulo}}" (load)="imagenCargada()" (error)="cargarImagenPlaceholder($event)">
    <div class="image-placeholder" *ngIf="cargandoImagen"></div>
    <span class="cat-badge" *ngIf="cuento.categoria">{{ cuento.categoria }}</span>
  </div>
  <div class="cuento-content">
    <h3 class="cuento-title">{{ cuento.titulo }}</h3>
    <div class="rating" *ngIf="cuento.rating">
      <span>{{ getRatingStars(cuento.rating) }}</span>
    </div>
    <p class="autor">Autor: {{ cuento.autor }}</p>
    <p class="excerpt">{{ cuento.descripcionCorta | slice:0:50 }}...</p>
    <div class="precio"><span class="cuento-price">S/ {{ cuento.precio | number:'1.2-2' }}</span></div>
  </div>

  <div class="acciones">
    <button class="ghost-btn" (click)="verDetalle()">Ver detalle</button>
    <button *ngIf="!isAdmin && cuento.habilitado" class="solid-btn" (click)="agregarAlCarrito()" [appFlyToCart]="cardImg">AÃ±adir carrito</button>
    <ng-container *ngIf="isAdmin">
      <button (click)="editarCuento()" class="admin-button editar hover-scale">Editar</button>
      <button (click)="deshabilitarCuento()" class="admin-button deshabilitar hover-scale">{{ cuento.habilitado ? 'Deshabilitar' : 'Habilitar' }}</button>
    </ng-container>
  </div>
  <div class="share-buttons">
    <button class="hover-scale" aria-label="Compartir por WhatsApp" (click)="compartir('whatsapp')">
      <img appLazyLoad="assets/whatsapp.svg" alt="WhatsApp">
    </button>
    <button class="hover-scale" aria-label="Compartir por Instagram" (click)="compartir('instagram')">
      <img appLazyLoad="assets/instagram.svg" alt="Instagram">
    </button>
  </div>
</div>
